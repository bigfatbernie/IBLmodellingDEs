%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%		Chapter 4 - Higher-Order Models
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{topic}[Higher-Order Models]



\vfil

\begin{center}
\begin{minipage}{500pt}
	\includegraphics*[width=500pt]{images/chap4-xkcd.png}

	\hfill {\footnotesize (image from \href{https://www.xkcd.com/226/}{xkcd - comic \#226})}
\end{minipage}
\end{center}


\end{topic}












%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  MODULE - Modelling with Second-Order ODEs
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\begin{module}{Modelling with Second-Order ODEs}
	\label{2nd:model}

	\input{modules/module20-2nd-model.tex}
	\input{modules/module20-2nd-model-exercises.tex}
\end{module}



\begin{lesson}
	\Title{Modelling with Second-Order ODEs I}

\Heading{Textbook}
	\begin{itemize}
		\item Module 19
	\end{itemize}

\Heading{Objectives}
	\begin{itemize}
		\item Model physical phenomena to obtain a second-order ODE
		\item Understand how to use Newton's Second Law of Motion
		\item Follow the step-by-step procedure to create a model
	\end{itemize}
	
\Heading{Motivation} 

By this point, the students should have a good idea on how the modelling task goes.

Models about moving objects often require Newton's Second Law of Motion which end up having the form of a second-order ODE.

Engineering and Physics students will find models like this often in their studies.



\Heading{Preparation for Class}
\begin{itemize}
	\item Read textbook
	\item Read the core exercise \ref{2nd:keyboard} and solve steps 1 (define problem), 2 (create a mind map), and 3 (make assumptions)
\end{itemize}


\end{lesson}




\question \label{2nd:keyboard}
	Here are some facts about laptop keys:

\begin{itemize}
\begin{minipage}{.4\textwidth}
\item[\color{Gray}(da)] Each key must also include some damping, so that it doesn't keep oscillating back and forth once pressed.

\item[\color{Gray}(di)] A typical letter key is 15mm$\times$15mm and when pressed has a maximum displacement of 0.5mm.

\item[\color{Gray}(fo)] On average, a person exerts the force of $42\,$N with one finger on a key.
\end{minipage}
\hfill
\begin{minipage}{.4\textwidth}
\item[\color{Gray}(gr)] Gravity is much weaker than the spring that keeps the key in place.

\item[\color{Gray}(hl)] Each key has a spring to make the key return to its original position after being pressed (Hooke's Law: ``the force is proportional to the extension'').

\item[\color{Gray}(lo)] Keys last 50 million presses on average.

\item[\color{Gray}(ve)] Keys can only move vertically.
\end{minipage}
\end{itemize}
	
\begin{annotation}
	\begin{goals}
		.1 should be very quick, since a very (very) similar example was solved in the module.
	\end{goals}
\end{annotation}
\begin{parts}
	\item Model a laptop keypress.
	\item What happens if the damping system of the key is broken? What happens if the damping system is too strong? How strong should the damping system be?
	\item What happens to the key when the spring breaks?
\end{parts}





\bookonlynewpage

\begin{lesson}
	\Title{Modelling with Second-Order ODEs II}

\Heading{Textbook}
	\begin{itemize}
		\item Module 19
	\end{itemize}
	
\Heading{Objectives}
	\begin{itemize}
		\item Model physical phenomena to obtain a second-order ODE
		\item Understand how to use Newton's Second Law of Motion
		\item Follow the step-by-step procedure to create a model
	\end{itemize}
	
\Heading{Motivation} 

This class, students work on a model that involves a bit more of Linear Algebra (projections) and some ``uglier'' expressions.


\Heading{Preparation for Class}
\begin{itemize}
	\item Read textbook
	\item Read the core exercise \ref{2nd:ballrolling} and solve steps 1 (define problem), 2 (create a mind map), and 3 (make assumptions)
\end{itemize}


\end{lesson}


\begin{annotation}
	\begin{goals}
		\Goal{Ball rolling}
		Different approach depending on students. \\
		
		\emph{Students need some challenge and have time}:
		\begin{itemize}
			\item Ramp $y=f(x)$ makes it simpler
			\item Need projection (Linear Algebra) to find gravity force along the ramp at $(x_0,y_0) = \big(x_0,f(x_0)\big)$:
			$$			
			\ell = (0,-mg) \cdot (1, k)\frac{1}{\sqrt{1+k^2}} = -\frac{mgk}{\sqrt{1+k^2}}
			$$
			where $k = f'(x_0)$.
			So gravity force along the ramp is:
			$$
			\vec{F}_g = \ell (1, k)\frac{1}{\sqrt{1+k^2}} = -\frac{mgk}{1+k^2} (1,k)
			$$
			\item Yields second-order ODE 
		\end{itemize}
		\hfil
		
		\emph{Weaker students with less time}:
		\begin{itemize}
			\item Give the formula for gravity force along the ramp:
			$$
			\vec{F}_g = \ell (1, k)\frac{1}{\sqrt{1+k^2}} = -\frac{mgk}{1+k^2} (1,k)
			$$
		\end{itemize}
		
		\hfil
		
		\emph{Follow-up question}:
		\begin{itemize}
			\item Ramp is $y=(x-1)^2$
			\item Get second-order ODE for ball position
			\item Will the ball always move to the right? Justify with the ODE.
			\item Approximate near the bottom of the ramp: $y' \approx 0 \Leftrightarrow \sqrt{1+(y')^2} \approx 1$ and solve the simpler ODE.
			\item When is this approximation valid? (when ball oscillates back and forth near the bottom)
		\end{itemize}
	\end{goals}
\end{annotation}
\question \label{2nd:ballrolling}
	Model a ball rolling down a ramp.

	



\standardonlynewpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  MODULE - Second-Order Linear ODEs with Constant Coefficients
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\begin{module}{Second-Order Linear ODEs with Constant Coefficients}
	\label{2nd:solving}

	\input{modules/module21-2nd-solve.tex}
	\input{modules/module21-2nd-solve-exercises.tex}
\end{module}



\begin{lesson}
	\Title{Second-Order Linear ODEs with Constant Coefficients I}

\Heading{Textbook}
	\begin{itemize}
		\item Module 20
	\end{itemize}

\Heading{Objectives}
	\begin{itemize}
		\item Understand the main idea: assuming the solution is $y=e^{rt}$ and find $r$
		\item Know how to find the characteristic equation and its solutions
		\item Find the general solution of a homogeneous ODE
	\end{itemize}
	
\Heading{Motivation} 


In this section we learn how to solve second-order linear ODEs with constant coefficients.

We do that by assuming that the solution is an exponential of the form $y=e^{rt}$. The intuition behind this comes from the systems of ODEs that we just studied.

Just like with systems, there are three possible cases, but its much simpler to solve them (especially the complex case).

In this lesson, solve the core exercises \ref{2nd:ode1}--\ref{2nd:ode3} for the complementary solutions.

\Heading{Preparation for Class}
\begin{itemize}
	\item Read textbook: Homogeneous ODEs
	\item Watch corresponding video
	\item Solve the core exercise \ref{2nd:ode1}.1
\end{itemize}

\end{lesson}




\question \label{2nd:ode1}
	Consider the ODE \quad $y''(t) -9y(t) = f(t)$.
\begin{parts}
	\item Find a complementary solution.
	\item Find a particular solution for $f(t) = 14 e^{-4t}$.
	\item Find a particular solution for $f(t) = 9 e^{-3t}$.
	\item Find a particular solution for $f(t) = 10\cos(t)$.
\end{parts}

\bookonlynewpage

\question \label{2nd:ode2}
	Consider the ODE \quad $y''(t) -2y'(t)+5y(t) = f(t)$. %(roots $r = 1 \pm 2i$)
\begin{parts}
	\item Find a complementary solution.
	\item Find a particular solution for $f(t) = \sin(2t)e^t$.
	\item Find a particular solution for $f(t) = (4t+2)\sin(2t)e^t$.
\end{parts}




\bookonlynewpage


\question \label{2nd:ode3}
	Consider the ODE \quad $y'' + 3y' = 3t$.
\begin{parts}
	\item Find the complementary solution.
	\item Find a particular solution.
	\item Find the solution that also satisfies
	$$ \begin{cases}
		y(0)=0 \\
		y'(0)=0
	\end{cases}$$
\end{parts}


\begin{lesson}
	\Title{Second-Order Linear ODEs with Constant Coefficients II}

\Heading{Textbook}
	\begin{itemize}
		\item Module 20
	\end{itemize}

\Heading{Objectives}
	\begin{itemize}
		\item Write the solution of a non-homogeneous ODE as $y=y_c+y_p$
		\item Use the Method of Undetermined Coefficients to find a particular solution
	\end{itemize}
	
\Heading{Motivation} 

This will include some more linear algebra! 

The Method of Undetermined Coefficients is very computational once the students have some practice with it. A good way to learn it is by giving only partial information and let students struggle a little before showing how to proceed: 
\begin{itemize}
	\item that's the idea behind core exercise \ref{2nd:ode1}, where the first two exercises are straight forwards, but then without more information the students will struggle to find the particular solution.
	\item After a little struggle in lecture, the instructor can then show the way.
\end{itemize}


In this class, solve the core exercises \ref{2nd:ode1}--\ref{2nd:ode3} for the particular solutions.

\Heading{Preparation for Class}
\begin{itemize}
	\item Read textbook: Non-Homogeneous ODEs
	\item Watch corresponding video
	\item Solve the core exercise \ref{2nd:ode2}.2-3.
\end{itemize}

\end{lesson}




\standardonlynewpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  MODULE - Analysis of Higher Order ODEs
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\begin{module}{Analysis of Models with Higher Order ODEs}
	\label{2nd:analysis}

	\input{modules/module22-2nd-analysis.tex}
	\input{modules/module22-2nd-analysis-exercises.tex}
\end{module}



\begin{lesson}
	\Title{Analysis of Models with Higher Order ODEs I}

\Heading{Textbook}
	\begin{itemize}
		\item Module 21
	\end{itemize}

\Heading{Objectives}
	\begin{itemize}
		\item Deduce properties of solutions of second-order of ODEs using different approaches
	\end{itemize}
	
\Heading{Motivation} 

As we have seen in the previous chapters, it is important to know how to analyze ODEs.

In this first lesson about the Analysis of ODEs, we start with some more qualitative properties deduced without finding the solution.

\Heading{Preparation for Class}
\begin{itemize}
	\item Read textbook
	\item Solve the core exercise \ref{2nd:analysis:ode1}.1
\end{itemize}

\end{lesson}





\question \label{2nd:analysis:ode1}
	Consider the second-order ODE:
	$$
	y''(t) - 3y(t) = t \big( 2 + \sin(t) \big).
	$$
	
\begin{annotation}
\begin{goals}
	\Goal{Without solution}
	The goal is to solve this without finding an expression for the solution.
	
	For .2, the idea is to make sure that $y''<0$. 
\end{goals}	
\end{annotation}
	\begin{parts}
		\item Assume that $y(0)=0$ and $y'(0)=b$. Which values of $b$ guarantee that $y(t)>0$ for $t\geq 0$. 
		\item Assume that $y(0)=a<0$ and $y'(0)=b$. Give an example of $a,b$ such that $y(t)$ is increasing for $t\geq 0$. 
		\item Assume that $y(0)=0$ and $y'(0)=b$. Which values of $b$ guarantee that $y(t)<0$ for all $t>0$.
\begin{annotation}
\begin{goals}
	If there is time, start the next core exercise.
\end{goals}
\end{annotation}


%\begin{align*}
%& y''(t) = t \big( 2 + \sin(t) \big)  + 3 y(t) < 0 
%	\quad \Leftrightarrow \quad 
%		y(t) < - \frac{t}{3} \big( 2 + \sin(t) \big) \\
%& y'(0) = -1 \\
%\\
%& y(0)<0, y'(0)= -1 \\
%& y''(0) < 0 \\
%	& y' \searrow \\
%	& y \searrow \\
%\end{align*}
%
%Since $y'(t)<-1$, that means $y(t) < -t$, thus
%$$
%y''(t) = 3 y(t)+ t \underbrace{\big( 2 + \sin(t) \big)}_{\leq 3}
%	< -3t + 3t 
%	= 0 
%$$
%which means that $y'$ will continue to decrease and $y$ will also continue to decrease, so it will continue to be negative.

	\end{parts}


	

\bookonlynewpage

\begin{lesson}
	\Title{Analysis of Models with Higher Order ODEs II}

\Heading{Textbook}
	\begin{itemize}
		\item Module 21
	\end{itemize}

\Heading{Objectives}
	\begin{itemize}
		\item Deduce interesting behaviours:
		\begin{itemize}
			\item Resonance
			\item Beats
		\end{itemize}
	\end{itemize}
	
\Heading{Motivation} 

As we have seen in the previous chapters, it is important to know how to analyze ODEs.

In this case, even after we find the solutions, the way they behave is hidden in the formula. We still need some work to find out the interesting behaviours that arise.

\Heading{Preparation for Class}
\begin{itemize}
	\item Read textbook
	\item Solve the core exercise \ref{2nd:analysis:ode2}.1--2
\end{itemize}

\end{lesson}

\begin{annotation}
\begin{goals}
	\Goal{Goals:}
	\begin{itemize}
		\item Learn some different types of behaviour of for second-order ODEs
		\item Learn how to sketch trig functions combined with linear or other trig functions
	\end{itemize}
	
	\hfill
	
	\begin{enumerate}[label=.\arabic*.]
		\item Complementary solution!
		\item \emph{Adding} two trig functions: one oscillating slowly and one oscillating quickly
		\item Resonance: $t$ times trig function
		\item Beats: \emph{product} of two trig functions -- one oscillating slowly and one oscillating quickly
	\end{enumerate}
\end{goals}	
\end{annotation}
\question \label{2nd:analysis:ode2}
	Consider the second-order ODE:
	$$
	\begin{cases}
	y''(t) +4 y(t) = f(t) \\
	y(0)=y_0\\
	y'(0)=0
	\end{cases}
	$$
	
	\begin{parts}
		\item Let $f(t)=0$ and $y_0=1$. Sketch the solution.
		\item Let $f(t)= 396\cos(20t)$ and $y_0=0$. Sketch the solution.
%		$$ y(t) = \cos(2t) - \cos(20t)$$

		\item Let $f(t) = -4\sin(2t)$ and $y_0=1$. Sketch the solution.
%		$$ y(t) = \cos(2t) +t\cos(2t) $$	

		\item Let $f(t) = 0.39\cos(1.9t)$ and $y_0=2$. Sketch the solution.
		
		\textbf{Hint. } $\displaystyle \cos(at) + \cos(bt) = 2 \cos\left( \frac{a-b}{2} \right)  \cos\left(\frac{a+b}{2} t \right)$
%		$$ y(t) = \cos(2t) + \cos(1.9t) = 2 \cos(0.1 t) \cos(1.95t)$$	
	\end{parts}



\standardonlynewpage
